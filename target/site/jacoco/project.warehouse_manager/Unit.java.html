<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>Unit.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">warehouse-manager</a> &gt; <a href="index.source.html" class="el_package">project.warehouse_manager</a> &gt; <span class="el_source">Unit.java</span></div><h1>Unit.java</h1><pre class="source lang-java linenums">package project.warehouse_manager;

import java.sql.*;
import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.List;

public class Unit extends DatabaseHandler{
	
<span class="fc" id="L12">	public Unit() { </span>
		
<span class="fc" id="L14">	}</span>
	
  	public ArrayList&lt;String&gt; displayLargeWarehouseData() throws SQLException{
<span class="fc" id="L17">  		ArrayList&lt;String&gt; largeUnitData = new ArrayList&lt;String&gt;();</span>
  
<span class="fc" id="L19">  			rs = st.executeQuery(&quot;SELECT * FROM units WHERE warehouseId = 1;&quot;);</span>
<span class="fc bfc" id="L20" title="All 2 branches covered.">  			while(rs.next()){ </span>
<span class="fc" id="L21">  				largeUnitData.add(rs.getString(&quot;id&quot;));</span>
<span class="fc" id="L22">  				largeUnitData.add(rs.getString(&quot;description&quot;));</span>
<span class="fc" id="L23">  				largeUnitData.add(rs.getString(&quot;customerId&quot;));</span>
<span class="fc" id="L24">  				largeUnitData.add(rs.getString(&quot;warehouseId&quot;));</span>
<span class="fc" id="L25">  				largeUnitData.add(rs.getString(&quot;occupied&quot;));</span>
<span class="fc" id="L26">  				largeUnitData.add(rs.getString(&quot;dateReceived&quot;));</span>
<span class="fc" id="L27">  				largeUnitData.add(rs.getString(&quot;pickupDate&quot;));</span>
<span class="fc" id="L28">  				largeUnitData.add(rs.getString(&quot;priority&quot;));</span>
<span class="fc" id="L29">  				largeUnitData.add(rs.getString(&quot;inQueue&quot;));</span>
<span class="fc" id="L30">  				largeUnitData.add(rs.getString(&quot;positionInQueue&quot;));</span>
  			}
  			try{
<span class="fc" id="L33">  				rs.close();</span>
<span class="fc" id="L34">  				st.close();</span>
  				}
<span class="nc" id="L36">  			catch(Exception e){</span>
<span class="fc" id="L37">  			}</span>
<span class="fc" id="L38">  			return largeUnitData;</span>
  	}
  	
  	public ArrayList&lt;UnitData&gt; getAllLargeWarehouseUnits() throws ClassNotFoundException, SQLException{
		
<span class="fc" id="L43">  		String sql = &quot;SELECT * FROM units WHERE warehouseId = 1&quot;;</span>
  	    ResultSet rst;
<span class="fc" id="L45">  	    rst = st.executeQuery(sql);</span>
<span class="fc" id="L46">  	    ArrayList&lt;UnitData&gt; UnitsList = new ArrayList&lt;UnitData&gt;();</span>
<span class="fc bfc" id="L47" title="All 2 branches covered.">  		while(rst.next()){</span>
<span class="fc" id="L48">  			UnitData unitData = new UnitData(rst.getInt(&quot;id&quot;)</span>
  					,rst.getString(&quot;description&quot;)
  					,rst.getInt(&quot;customerId&quot;)
  					,rst.getInt(&quot;warehouseId&quot;)
  					,rst.getInt(&quot;occupied&quot;)
  					,rst.getString(&quot;dateReceived&quot;)
  					,rst.getString(&quot;pickupDate&quot;)
  					,rst.getInt(&quot;inQueue&quot;)
  					);
<span class="fc" id="L57">  			UnitsList.add(unitData);</span>
<span class="fc" id="L58">  		}</span>
<span class="fc" id="L59">  		return UnitsList;</span>
  	}
  	
  	public ArrayList&lt;UnitData&gt; getAllSmallWarehouseUnits() throws ClassNotFoundException, SQLException{
		
<span class="fc" id="L64">  		String sql = &quot;SELECT * FROM units WHERE warehouseId = 2&quot;;</span>
  	    ResultSet rst;
<span class="fc" id="L66">  	    rst = st.executeQuery(sql);</span>
<span class="fc" id="L67">  	    ArrayList&lt;UnitData&gt; UnitsList = new ArrayList&lt;UnitData&gt;();</span>
<span class="fc bfc" id="L68" title="All 2 branches covered.">  		while(rst.next()){</span>
<span class="fc" id="L69">  			UnitData unitData = new UnitData(rst.getInt(&quot;id&quot;)</span>
  					,rst.getString(&quot;description&quot;)
  					,rst.getInt(&quot;customerId&quot;)
  					,rst.getInt(&quot;warehouseId&quot;)
  					,rst.getInt(&quot;occupied&quot;)
  					,rst.getString(&quot;dateReceived&quot;)
  					,rst.getString(&quot;pickupDate&quot;)
  					,rst.getInt(&quot;inQueue&quot;)
  					);
<span class="fc" id="L78">  			UnitsList.add(unitData);</span>
<span class="fc" id="L79">  		}</span>
  		
<span class="fc" id="L81">  		return UnitsList;</span>
  	}
  	
  	public ArrayList&lt;String&gt; displaySmallWarehouseData() throws SQLException{
<span class="fc" id="L85">  		ArrayList&lt;String&gt; smallUnitData = new ArrayList&lt;String&gt;();</span>
  
<span class="fc" id="L87">  			rs = st.executeQuery(&quot;SELECT * FROM units WHERE warehouseId = 2;&quot;);</span>
<span class="fc bfc" id="L88" title="All 2 branches covered.">  			while(rs.next()){ </span>
<span class="fc" id="L89">  				smallUnitData.add(rs.getString(&quot;id&quot;));</span>
<span class="fc" id="L90">  				smallUnitData.add(rs.getString(&quot;description&quot;));</span>
<span class="fc" id="L91">  				smallUnitData.add(rs.getString(&quot;customerId&quot;));</span>
<span class="fc" id="L92">  				smallUnitData.add(rs.getString(&quot;warehouseId&quot;));</span>
<span class="fc" id="L93">  				smallUnitData.add(rs.getString(&quot;occupied&quot;));</span>
<span class="fc" id="L94">  				smallUnitData.add(rs.getString(&quot;dateReceived&quot;));</span>
<span class="fc" id="L95">  				smallUnitData.add(rs.getString(&quot;pickupDate&quot;));</span>
<span class="fc" id="L96">  				smallUnitData.add(rs.getString(&quot;priority&quot;));</span>
<span class="fc" id="L97">  				smallUnitData.add(rs.getString(&quot;inQueue&quot;));</span>
<span class="fc" id="L98">  				smallUnitData.add(rs.getString(&quot;positionInQueue&quot;));</span>
  			}
  			
  			try{
<span class="fc" id="L102">  				rs.close();</span>
  				//st.close();
  				}
<span class="nc" id="L105">  			catch(Exception e){</span>
<span class="nc" id="L106">  				System.out.println(&quot;Error closing the database&quot;);</span>
<span class="fc" id="L107">  			}</span>
<span class="fc" id="L108">  			return smallUnitData;</span>
  	}
	
	//displays the empty units in the large warehouse
	public ArrayList&lt;Integer&gt; getEmptyUnitsInLarge() throws SQLException{
<span class="fc" id="L113">		ArrayList&lt;Integer&gt; largeUnitEmpty = new ArrayList&lt;Integer&gt;();</span>

<span class="fc" id="L115">			rs = st.executeQuery(&quot;SELECT * FROM units WHERE warehouseID = 1 AND occupied = 0;&quot;);</span>
<span class="fc bfc" id="L116" title="All 2 branches covered.">			while (rs.next()) {</span>
<span class="fc" id="L117">				largeUnitEmpty.add(rs.getInt(&quot;id&quot;));</span>
				  
			}
			
	
  			try{
<span class="fc" id="L123">  				rs.close();</span>
  			//	st.close();
  				}
<span class="pc" id="L126">  			catch(Exception e){	}</span>
<span class="fc" id="L127">  			return largeUnitEmpty;</span>
	}
	
	//displays the empty units in the large warehouse
	public ArrayList&lt;Integer&gt; getEmptyUnitsInSmall() throws SQLException{
<span class="fc" id="L132">		ArrayList&lt;Integer&gt; smallUnitEmpty = new ArrayList&lt;Integer&gt;();</span>
	
<span class="fc" id="L134">			rs = st.executeQuery(&quot;SELECT * FROM units WHERE warehouseID = 2 AND occupied = 0;&quot;);</span>
<span class="fc bfc" id="L135" title="All 2 branches covered.">			while (rs.next()) {</span>
<span class="fc" id="L136">				smallUnitEmpty.add(rs.getInt(&quot;id&quot;));</span>
				  
			}
	
  			try{
<span class="fc" id="L141">  				rs.close();</span>
  			//	st.close();
  				}
<span class="nc" id="L144">  			catch(Exception e){</span>
<span class="fc" id="L145">  			}</span>
<span class="fc" id="L146">  			return smallUnitEmpty;</span>
	}
	
	// Customer units in small
	public ArrayList&lt;Integer&gt; getCustomerUnitsInSmall(int customerId) throws SQLException{
<span class="fc" id="L151">		ArrayList&lt;Integer&gt; smallUnitEmpty = new ArrayList&lt;Integer&gt;();</span>
	
<span class="fc" id="L153">			rs = st.executeQuery(&quot;SELECT * FROM units WHERE warehouseID = 2 AND customerId = &quot; + customerId + &quot;;&quot;);</span>
<span class="fc bfc" id="L154" title="All 2 branches covered.">			while (rs.next()) {</span>
<span class="fc" id="L155">				smallUnitEmpty.add(rs.getInt(&quot;id&quot;));</span>
				  
			}

  			try{
<span class="fc" id="L160">  				rs.close();</span>
  			//	st.close();
  				}
<span class="nc" id="L163">  			catch(Exception e){</span>
<span class="fc" id="L164">  			}</span>
  			
<span class="fc" id="L166">  			return smallUnitEmpty;</span>
	}
	
	//customer units in large
	public ArrayList&lt;Integer&gt; getCustomerUnitsInLarge(int customerId) throws SQLException{
<span class="fc" id="L171">		ArrayList&lt;Integer&gt; smallUnitEmpty = new ArrayList&lt;Integer&gt;();</span>
	
<span class="fc" id="L173">			rs = st.executeQuery(&quot;SELECT * FROM units WHERE warehouseID = 1 AND customerId = &quot; + customerId + &quot;;&quot;);</span>
<span class="fc bfc" id="L174" title="All 2 branches covered.">			while (rs.next()) {</span>
<span class="fc" id="L175">				smallUnitEmpty.add(rs.getInt(&quot;id&quot;));</span>
				  
			}
			
  			try{
<span class="fc" id="L180">  				rs.close();</span>
<span class="fc" id="L181">  				st.close();</span>
  				}
<span class="nc" id="L183">  			catch(Exception e){</span>
<span class="fc" id="L184">  			}</span>
<span class="fc" id="L185">  			return smallUnitEmpty;</span>
	}
	
	// returns the amount of large warehouse units that are currently empty
	public int getNumberOfEmptyUnitsInLarge() throws SQLException{
<span class="fc" id="L190">		int emptyLargeWare = 0;</span>

<span class="fc" id="L192">			rs = st.executeQuery(&quot;SELECT COUNT(*) AS total FROM units WHERE warehouseID = 1 AND occupied = 0;&quot;);</span>
<span class="fc" id="L193">			emptyLargeWare = rs.getInt(&quot;total&quot;);</span>

  			try{
<span class="fc" id="L196">  				rs.close();</span>
<span class="fc" id="L197">  				st.close();</span>
  				}
<span class="nc" id="L199">  			catch(Exception e){</span>
<span class="fc" id="L200">  			}</span>
<span class="fc" id="L201">  			return emptyLargeWare;</span>
	}
	
	// returns the amount of small warehouses that are currently empty
	public int getNumberOfEmptyUnitsInSmall() throws SQLException{
<span class="fc" id="L206">		int emptySmallWare = 0;</span>
<span class="fc" id="L207">			rs = st.executeQuery(&quot;SELECT COUNT(*) AS total FROM units WHERE warehouseID = 2 AND occupied = 0;&quot;);</span>

<span class="fc" id="L209">			emptySmallWare = rs.getInt(&quot;total&quot;);</span>
			
			
			

  			try{
<span class="fc" id="L215">  				rs.close();</span>
<span class="fc" id="L216">  				st.close();</span>
  				}
<span class="nc" id="L218">  			catch(Exception e){</span>
<span class="nc" id="L219">  				System.out.println(&quot;Error closing the database&quot;);</span>
<span class="fc" id="L220">  			}</span>
<span class="fc" id="L221">  			return emptySmallWare;</span>
	}
		
	//small units per customer id
	public int getNumberOfUnitsOwnedInSmallByCustomerId(int customerId) throws SQLException{
<span class="fc" id="L226">		int unitsInSmall = 0;</span>
	
<span class="fc" id="L228">			rs = st.executeQuery(&quot;SELECT Count(*) AS total FROM units WHERE customerId = &quot; + customerId  +&quot; AND warehouseId = 2;&quot;);</span>
<span class="fc" id="L229">			unitsInSmall = rs.getInt(&quot;total&quot;);</span>
  			try{
<span class="fc" id="L231">  				rs.close();</span>
<span class="fc" id="L232">  				st.close();</span>
  				}
<span class="pc" id="L234">  			catch(Exception e){	}</span>
<span class="fc" id="L235">  			return unitsInSmall;</span>
	}
	
	//small units per customer id
	public int getNumberOfUnitsOwnedInLargeByCustomerId(int customerId) throws SQLException{
<span class="fc" id="L240">		int unitsInSmall = 0;</span>
		
<span class="fc" id="L242">			rs = st.executeQuery(&quot;SELECT Count(*) AS total FROM units WHERE customerId = &quot; + customerId  +&quot; AND warehouseId = 1;&quot;);</span>
<span class="fc" id="L243">			unitsInSmall = rs.getInt(&quot;total&quot;);</span>
		
  			try{
<span class="fc" id="L246">  				rs.close();</span>
<span class="fc" id="L247">  				st.close();</span>
  				}
<span class="pc" id="L249">  			catch(Exception e){	}</span>
<span class="fc" id="L250">  			return unitsInSmall;</span>
	}
		
	// adds a customer and their belongings to a unit
	public boolean fillUnit(String description, int customerId, String pickupDate, int unitId){
<span class="fc" id="L255">		DateFormat dateFormat = new SimpleDateFormat(&quot;dd/MM/yyyy&quot;);</span>
<span class="fc" id="L256">		Calendar cal = Calendar.getInstance();</span>
<span class="fc" id="L257">		String date = dateFormat.format(cal.getTime());</span>
		try {
<span class="fc" id="L259">			st.executeUpdate(&quot;UPDATE units SET description ='&quot; + description + </span>
							 &quot;', customerId = &quot; + customerId + &quot;, occupied = 1, dateReceived ='&quot; +
							 date + &quot;', pickupDate ='&quot; + pickupDate + &quot;'WHERE id =&quot; + unitId + &quot;;&quot;);	
<span class="fc" id="L262">			return true;</span>
<span class="nc" id="L263">		}catch (SQLException e) {</span>
<span class="nc" id="L264">			e.printStackTrace();</span>
<span class="nc" id="L265">			return false;</span>
		}finally{
<span class="nc" id="L267">  			try{</span>
<span class="nc" id="L268">  				rs.close();</span>
  				//st.close();
  				}
<span class="pc" id="L271">  			catch(Exception e){</span>
<span class="pc" id="L272">  			}</span>
  		}
	}
	
	// adds a customer and their belongings to a unit
	public boolean repopulateTables(List&lt;UnitData&gt; largeWarehouseUnitList,
			List&lt;UnitData&gt; smallWarehouseUnitList){
			
		try {
			
<span class="fc bfc" id="L282" title="All 2 branches covered.">			for (UnitData unitData : largeWarehouseUnitList) {</span>
				//converting the date into a string
<span class="fc" id="L284">				DateFormat dateFormat = new SimpleDateFormat(&quot;dd/MM/yyyy&quot;);</span>
				String date;
<span class="fc bfc" id="L286" title="All 2 branches covered.">				if (unitData.getPickUpDate() == null) {</span>
<span class="fc" id="L287">					date = &quot;null&quot;;</span>
				} else {
<span class="fc" id="L289">					date = dateFormat.format(unitData.getPickUpDate().getTime());</span>
				}
<span class="fc" id="L291">				st.executeUpdate(&quot;UPDATE units SET description ='&quot; + unitData.getDescription() + </span>
						 &quot;', customerId = &quot; + unitData.getCustomerId() + &quot;, occupied = &quot; + unitData.getOccupied() 
						 + &quot;, dateReceived ='&quot; + unitData.getDateReceived() + &quot;', pickUpDate = '&quot; + date 
						 + &quot;' WHERE id =&quot; + unitData.getId() + &quot;;&quot;);
<span class="fc" id="L295">			}</span>
			
<span class="fc bfc" id="L297" title="All 2 branches covered.">			for (UnitData unitData : smallWarehouseUnitList) {</span>
				//converting the date into a string
<span class="fc" id="L299">				DateFormat dateFormat = new SimpleDateFormat(&quot;dd/MM/yyyy&quot;);</span>
				String date;
<span class="pc bpc" id="L301" title="1 of 2 branches missed.">				if (unitData.getPickUpDate() == null) {</span>
<span class="fc" id="L302">					date = &quot;null&quot;;</span>
				} else {
<span class="nc" id="L304">					date = dateFormat.format(unitData.getPickUpDate().getTime());</span>
				}
<span class="fc" id="L306">				st.executeUpdate(&quot;UPDATE units SET description ='&quot; + unitData.getDescription() + </span>
						 &quot;', customerId = &quot; + unitData.getCustomerId() + &quot;, occupied = &quot; + unitData.getOccupied() 
						 + &quot;, dateReceived ='&quot; + unitData.getDateReceived() + &quot;', pickUpDate = '&quot; + date 
						 + &quot;' WHERE id =&quot; + unitData.getId() + &quot;;&quot;);
<span class="fc" id="L310">			}</span>
			
						
<span class="fc" id="L313">			return true;</span>
<span class="nc" id="L314">		}catch (SQLException e) {</span>
<span class="nc" id="L315">			e.printStackTrace();</span>
<span class="nc" id="L316">			return false;</span>
		}finally{
<span class="nc" id="L318">  			try{</span>
<span class="nc" id="L319">  				rs.close();</span>
  				//st.close();
  				}
<span class="pc" id="L322">  			catch(Exception e){</span>
<span class="pc" id="L323">  			}</span>
  		}
	}
	
	//empties a unit, leaving it ready for more items
	public boolean removeUnit(int unitId){
<span class="fc" id="L329">		boolean success = false;</span>
		try {
<span class="fc" id="L331">			st.executeUpdate(&quot;UPDATE units SET description = 'empty unit', customerId = 0, occupied = 0, dateReceived = 'null', pickupDate = 'null' WHERE id =&quot; + unitId + &quot;;&quot;);</span>
<span class="fc" id="L332">			success = true;</span>
<span class="fc" id="L333">			return success;</span>
<span class="nc" id="L334">		}catch (SQLException e) {</span>
<span class="nc" id="L335">			e.printStackTrace();</span>
<span class="nc" id="L336">			return success;</span>
		}finally{
<span class="nc" id="L338">  			try{</span>
<span class="nc" id="L339">  				rs.close();</span>
  			//	st.close();
  				}
<span class="pc" id="L342">  			catch(Exception e){</span>
 
<span class="pc" id="L344">  			}</span>
  		}
	}
	
	// retrieving a unit by customer ID
	public int totalUnitsByCustomer(int customerId) throws SQLException{
<span class="fc" id="L350">		int totalUnits = 0;</span>
	
<span class="fc" id="L352">			rs = st.executeQuery(&quot;SELECT COUNT(*) AS total FROM units WHERE customerId = &quot; + customerId  +&quot;;&quot;);</span>
<span class="fc" id="L353">			totalUnits = rs.getInt(&quot;total&quot;);</span>

  			try{
<span class="fc" id="L356">  				rs.close();</span>
<span class="fc" id="L357">  				st.close();</span>
  				}
<span class="nc" id="L359">  			catch(Exception e){</span>
 
<span class="fc" id="L361">  			}</span>
<span class="fc" id="L362">  			return totalUnits;</span>
	}
	
	// retrieving a unit by unit ID
	public ArrayList&lt;String&gt; unitsById(int unitId) throws SQLException{
<span class="fc" id="L367">		ArrayList&lt;String&gt; unitData = new ArrayList&lt;String&gt;();</span>
	
<span class="fc" id="L369">			rs = st.executeQuery(&quot;SELECT * FROM units WHERE id = &quot; + unitId  +&quot;;&quot;);</span>
<span class="fc" id="L370">				  unitData.add(rs.getString(&quot;description&quot;));</span>
<span class="fc" id="L371">				  unitData.add(rs.getString(&quot;warehouseId&quot;));</span>
<span class="fc" id="L372">				  unitData.add(rs.getString(&quot;occupied&quot;));</span>
<span class="fc" id="L373">				  unitData.add(rs.getString(&quot;dateReceived&quot;));</span>
<span class="fc" id="L374">				  unitData.add(rs.getString(&quot;pickupDate&quot;));</span>
<span class="fc" id="L375">				  unitData.add(rs.getString(&quot;priority&quot;));</span>
<span class="fc" id="L376">				  unitData.add(rs.getString(&quot;inQueue&quot;));</span>
<span class="fc" id="L377">				  unitData.add(rs.getString(&quot;positionInQueue&quot;));</span>
				  
			
  			try{
<span class="fc" id="L381">  				rs.close();</span>
<span class="fc" id="L382">  				st.close();</span>
  				}
<span class="pc" id="L384">  			catch(Exception e){	}</span>
<span class="fc" id="L385">  			return unitData;</span>
	}
	
	
	
	// alters the pickup date of a occupied unit
	public boolean changePickupDate(String pickupDate, int unitId){
<span class="fc" id="L392">		boolean status = false;</span>
		try {
<span class="fc" id="L394">			st.executeUpdate(&quot;UPDATE units SET pickupDate ='&quot; + pickupDate + &quot;' WHERE id = &quot; + unitId + &quot;;&quot;);	</span>
<span class="fc" id="L395">			status = true;</span>
<span class="fc" id="L396">			return status;</span>
<span class="nc" id="L397">		}catch (SQLException e) {</span>
<span class="nc" id="L398">			e.printStackTrace();</span>
<span class="nc" id="L399">			return status;</span>
		}finally{
<span class="nc" id="L401">  			try{</span>
<span class="nc" id="L402">  				rs.close();</span>
<span class="nc" id="L403">  				st.close();</span>
  				}
<span class="pc" id="L405">  			catch(Exception e){	}</span>
  		}	
	}
	
	//allows for the altering of description
	public boolean changeDescription(String description, int unitId){
<span class="fc" id="L411">		boolean status = false;</span>
		try {
<span class="fc" id="L413">			st.executeUpdate(&quot;UPDATE units SET description ='&quot; + description + &quot;' WHERE id = &quot; + unitId + &quot;;&quot;);	</span>
<span class="fc" id="L414">			status = true;</span>
<span class="fc" id="L415">			return status;</span>
<span class="nc" id="L416">		}catch (SQLException e) {</span>
<span class="nc" id="L417">			e.printStackTrace();</span>
<span class="nc" id="L418">			return status;</span>
		}finally{
<span class="nc" id="L420">  			try{</span>
<span class="nc" id="L421">  				rs.close();</span>
  			//	st.close();
  				}
<span class="pc" id="L424">  			catch(Exception e){</span>
  				
<span class="pc" id="L426">  			}</span>
  		}			
	}
	
	public int numberOfItemsInQueue() throws SQLException{
<span class="fc" id="L431">		int queued = 9000;</span>
<span class="fc" id="L432">			rs = st.executeQuery(&quot;SELECT COUNT(*)  AS total FROM units WHERE inQueue = 1;&quot;);</span>
<span class="fc" id="L433">			queued = rs.getInt(&quot;total&quot;);</span>
  			try{
<span class="fc" id="L435">  				rs.close();</span>
<span class="fc" id="L436">  				st.close();</span>
  				}
<span class="pc" id="L438">  			catch(Exception e){	}</span>
<span class="fc" id="L439">  			return queued;</span>
	}
	
	// empties the small warehouse
	public boolean purgeSmall(){
<span class="fc" id="L444">		boolean success = false;</span>
		try {
			//st.executeUpdate(&quot;UPDATE units SET description = 'empty unit', customerId = 0, occupied = 0, dateReceived = 'null', pickupDate = 'null' WHERE warehouseId = 2;&quot;);
<span class="fc" id="L447">			rs = st.executeQuery(&quot;SELECT * FROM units WHERE warehouseId = 1;&quot;);</span>
<span class="fc" id="L448">			success = true;</span>
<span class="fc" id="L449">			return success;</span>
<span class="nc" id="L450">		}catch (SQLException e) {</span>
<span class="nc" id="L451">			e.printStackTrace();</span>
<span class="nc" id="L452">			return success;</span>
		}finally{
<span class="nc" id="L454">  			try{</span>
<span class="pc" id="L455">  				rs.close();</span>
  			//	st.close();
  				}
<span class="nc" id="L458">  			catch(Exception e){</span>
 
<span class="pc" id="L460">  			}</span>
  		}
	}
	
		//changes whether the item is in queue or not
	/*
		public boolean changeQueueStatus(int queueStatus, int unitId){
			try {
				st.executeUpdate(&quot;UPDATE units SET inQueue = &quot; + queueStatus + &quot; WHERE id=&quot; + unitId + &quot;;&quot;);
				return true;
			} catch (SQLException e) {
				e.printStackTrace();
				return false;
			}finally{
	  			try{
	  				rs.close();
	  	//			st.close();
	  				}
	  			catch(Exception e){
	  			
	  			}
	  		}				
		}
		*/
		/*
		// moves an item from a large warehouse unit to a small one
		public void moveToSmall(int largeUnitId, int smallUnitId){
			try {
				rs = st.executeQuery(&quot;SELECT * FROM units WHERE id = &quot; + largeUnitId  +&quot;;&quot;);
			
				String description 	= rs.getString(&quot;description&quot;);
				int customerId 		= rs.getInt(&quot;customerId&quot;);
				String dateReceived 	= rs.getString(&quot;dateReceived&quot;);
				String pickupDate		= rs.getString(&quot;pickupDate&quot;);
				int priority 			= rs.getInt(&quot;priority&quot;);
				
				st.executeUpdate(&quot;UPDATE units SET description ='&quot; + description + 
						&quot;', customerId = &quot; + customerId + &quot;, occupied = 1, dateReceived ='&quot; +
						dateReceived + &quot;', pickupDate ='&quot; + pickupDate + &quot;', priority =&quot; + 
						priority + &quot; WHERE id =&quot; + smallUnitId + &quot;;&quot;);		
					  
				st.executeUpdate(&quot;UPDATE units SET description = 'empty unit', customerId = 0, occupied = 0, dateReceived = 'null', pickupDate = 'null' WHERE id =&quot; + largeUnitId + &quot;;&quot;);
						
			}catch (SQLException e) {
				e.printStackTrace();
			}finally{
	  			try{
	  				rs.close();
	  	//			st.close();
	  				}
	  			catch(Exception e){
	  				System.out.println(&quot;Error closing the database&quot;);
	  			}
	  		}	
		}
		*/
		//empties all units pertaining to a specific customer
		public boolean emptyUnitByCustomer(int customerId){
			try {
<span class="fc" id="L519">				st.executeUpdate(&quot;UPDATE units SET description = 'empty unit', occupied = 0, dateReceived = 'null', pickupDate = 'null' WHERE customerId =&quot; + customerId + &quot;;&quot;);</span>
<span class="fc" id="L520">				return true;</span>
<span class="nc" id="L521">			}catch (SQLException e) {</span>
<span class="nc" id="L522">				e.printStackTrace();</span>
<span class="nc" id="L523">				return false;</span>
			}finally{
<span class="nc" id="L525">	  			try{</span>
<span class="nc" id="L526">	  				rs.close();</span>
	  	//			st.close();
	  				}
<span class="pc" id="L529">	  			catch(Exception e){</span>
<span class="pc" id="L530">	  				System.out.println(&quot;Error closing the database&quot;);</span>
<span class="pc" id="L531">	  			}</span>
	  		}		
			
		}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.4.201502262128</span></div></body></html>