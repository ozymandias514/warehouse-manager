<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>Customer.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">warehouse-manager</a> &gt; <a href="index.source.html" class="el_package">project.warehouse_manager</a> &gt; <span class="el_source">Customer.java</span></div><h1>Customer.java</h1><pre class="source lang-java linenums">package project.warehouse_manager;

import java.util.ArrayList;
import java.sql.*;

public class Customer extends DatabaseHandler{

<span class="nc" id="L8">	public Customer() {</span>
		
<span class="nc" id="L10">	}</span>
	
	//obtains all the data from all customers
  	public boolean getDataFromCustomer(){
  		try {
<span class="nc" id="L15">  			rs = st.executeQuery(&quot;SELECT * FROM customer;&quot;);</span>
<span class="nc" id="L16">  			System.out.println(&quot;id    firstName         lastName        email&quot;);</span>
<span class="nc" id="L17">  			System.out.print(&quot;---   ------------      -----------     ----------&quot;);</span>
<span class="nc" id="L18">  			System.out.println();</span>
<span class="nc bnc" id="L19" title="All 2 branches missed.">  			while (rs.next()) {</span>
<span class="nc" id="L20">  				  int id = rs.getInt(&quot;id&quot;);</span>
<span class="nc" id="L21">  				  String firstName = rs.getString(&quot;firstName&quot;);</span>
<span class="nc" id="L22">  				  String lastName = rs.getString(&quot;lastName&quot;);</span>
<span class="nc" id="L23">  				  String email = rs.getString(&quot;email&quot;);</span>
<span class="nc" id="L24">  				  System.out.printf(&quot;%d     %s		%s		%s&quot;, id, firstName, lastName, email);</span>
<span class="nc" id="L25">  				  System.out.println();</span>
<span class="nc" id="L26">  				}</span>
<span class="nc" id="L27">  			return true;</span>
<span class="nc" id="L28">  		} catch (SQLException e) {</span>
<span class="nc" id="L29">  			e.printStackTrace();</span>
<span class="nc" id="L30">  			return false;</span>
  		}finally{
<span class="nc" id="L32">  			try{</span>
<span class="nc" id="L33">  				rs.close();</span>
<span class="nc" id="L34">  				st.close();</span>
  				}
<span class="nc" id="L36">  			catch(Exception e){</span>
<span class="nc" id="L37">  				System.out.println(&quot;Error closing the database&quot;);</span>
<span class="nc" id="L38">  			}</span>
  		}			
  	}
  	
    //obtains all data from customers and returns the resultSet
  	public ArrayList&lt;String&gt; displayData(){
<span class="nc" id="L44">  		ArrayList&lt;String&gt; userData = new ArrayList&lt;String&gt;();</span>
  		try {
<span class="nc" id="L46">  			rs = st.executeQuery(&quot;SELECT * FROM customer;&quot;);</span>
<span class="nc bnc" id="L47" title="All 2 branches missed.">  			while(rs.next()){</span>
<span class="nc" id="L48">  			 userData.add(rs.getString(&quot;id&quot;));</span>
<span class="nc" id="L49">			 userData.add(rs.getString(&quot;firstName&quot;));</span>
<span class="nc" id="L50">			 userData.add(rs.getString(&quot;lastName&quot;));</span>
<span class="nc" id="L51">			 userData.add(rs.getString(&quot;email&quot;));</span>
  			}
<span class="nc" id="L53">  			return userData;</span>
<span class="nc" id="L54">  		} catch (SQLException e) {</span>
<span class="nc" id="L55">  			e.printStackTrace();</span>
<span class="nc" id="L56">  			return null;</span>
  		}finally{
<span class="nc" id="L58">  			try{</span>
<span class="nc" id="L59">  				rs.close();</span>
<span class="nc" id="L60">  				st.close();</span>
  				}
<span class="nc" id="L62">  			catch(Exception e){</span>
<span class="nc" id="L63">  				System.out.println(&quot;Error closing the database&quot;);</span>
<span class="nc" id="L64">  			}</span>
  		}
  	}
  	
  	//adds a customer to the system
  	public boolean addCustomer(String firstName, String lastName, String email){
  		
  		//String emailExtension = &quot;@gmail.com&quot;;
  		try {  			
<span class="nc" id="L73">  			st.executeUpdate(&quot;INSERT INTO customer(firstName, lastName, email) VALUES ('&quot;+</span>
  					firstName + &quot;', '&quot; + lastName + &quot;', '&quot;+ email + &quot;');&quot;);	
<span class="nc" id="L75">  			return true;</span>
<span class="nc" id="L76">  		}catch (SQLException e) {</span>
<span class="nc" id="L77">  			e.printStackTrace();</span>
<span class="nc" id="L78">  			return false;</span>
  		}finally{
<span class="nc" id="L80">  			try{</span>
<span class="nc" id="L81">  				rs.close();</span>
<span class="nc" id="L82">  				st.close();</span>
  				}
<span class="nc" id="L84">  			catch(Exception e){</span>
  				
<span class="nc" id="L86">  			}</span>
  		}	
  	}
  	
  	//adds a customer to the system
  	public boolean addCustomerWithId(int id, String firstName, String lastName, String email){
<span class="nc" id="L92">  		String taskAchieved = &quot;failed&quot;;</span>
  		//String emailExtension = &quot;@gmail.com&quot;;
  		try {  			
<span class="nc" id="L95">  			st.executeUpdate(&quot;INSERT INTO customer(id, firstName, lastName, email) VALUES (&quot; + id+ &quot;, '&quot;+</span>
  					firstName + &quot;', '&quot; + lastName + &quot;', '&quot;+ email + &quot;');&quot;);	
<span class="nc" id="L97">  			return true;</span>
<span class="nc" id="L98">  		}catch (SQLException e) {</span>
<span class="nc" id="L99">  			e.printStackTrace();</span>
<span class="nc" id="L100">  			return false;</span>
  		}finally{
<span class="nc" id="L102">  			try{</span>
<span class="nc" id="L103">  				rs.close();</span>
<span class="nc" id="L104">  				st.close();</span>
  				}
<span class="nc" id="L106">  			catch(Exception e){</span>
  				
<span class="nc" id="L108">  			}</span>
  		}	
  	}
  	
  	//deletes a customer
  	public boolean deleteCustomer(int customerId){
  		Connection con;
<span class="nc" id="L115">  		Statement st = null;</span>
<span class="nc" id="L116">  		ResultSet rs = null;</span>
  		
  		try {
<span class="nc" id="L119">  			Class.forName(&quot;org.sqlite.JDBC&quot;);</span>
<span class="nc" id="L120">  			con = DriverManager.getConnection(&quot;jdbc:sqlite:warehouse.db&quot;);</span>
<span class="nc" id="L121">  			st = con.createStatement();</span>
<span class="nc" id="L122">  		}catch(Exception e){</span>
  			
<span class="nc" id="L124">  			System.err.println( e.getClass().getName() + &quot;: &quot; + e.getMessage() );</span>
<span class="nc" id="L125">  			System.exit(0);</span>
<span class="nc" id="L126">  			}</span>
  			
<span class="nc" id="L128">  		boolean taskAchieved = false;</span>
  		try {
  			//empties the units associated with the customer first
  			//emptyUnitByCustomer(customerId);
  			// Need to purge the customers
  			// then deletes the customer from the database
<span class="nc" id="L134">  			st.executeUpdate(&quot;DELETE FROM customer WHERE id=&quot;+ customerId +&quot;;&quot;);		</span>
<span class="nc" id="L135">  			taskAchieved = true;</span>
<span class="nc" id="L136">  			return taskAchieved;</span>
<span class="nc" id="L137">  		}catch (SQLException e) {</span>
<span class="nc" id="L138">  			e.printStackTrace();</span>
<span class="nc" id="L139">  			return taskAchieved;</span>
  		}finally{
<span class="nc" id="L141">  			try{</span>
<span class="nc" id="L142">  				rs.close();</span>
<span class="nc" id="L143">  				st.close();</span>
  				}
<span class="nc" id="L145">  			catch(Exception e){</span>
<span class="nc" id="L146">  				System.out.println(&quot;Error closing the database&quot;);</span>
<span class="nc" id="L147">  			}</span>
  		}
  	}
  	
  	//sets a new first name for an existing customer
  	public boolean changeCustomerFirstName(int customerId, String newFirstName){
  		try {
<span class="nc" id="L154">  			st.executeUpdate(&quot;UPDATE customer SET firstName = '&quot;+ newFirstName +</span>
  					&quot;' WHERE id = &quot;+ customerId +&quot;;&quot;);		
<span class="nc" id="L156">  			return true;</span>
<span class="nc" id="L157">  		}catch (SQLException e) {</span>
<span class="nc" id="L158">  			e.printStackTrace();</span>
<span class="nc" id="L159">  			return false;</span>
  		}finally{
<span class="nc" id="L161">  			try{</span>
<span class="nc" id="L162">  				rs.close();</span>
<span class="nc" id="L163">  				st.close();</span>
  				}
<span class="nc" id="L165">  			catch(Exception e){</span>
<span class="nc" id="L166">  				System.out.println(&quot;Error closing the database&quot;);</span>
<span class="nc" id="L167">  			}</span>
  		}	
  	}
  	
  	//sets a new last name for an existing customer
  	public boolean changeCustomerLastName(int customerId, String newLastName){
  		try {
<span class="nc" id="L174">  			st.executeUpdate(&quot;UPDATE customer SET lastName = '&quot;+ newLastName +</span>
  					&quot;' WHERE id = &quot;+ customerId +&quot;;&quot;);			
<span class="nc" id="L176">  			return true;</span>
<span class="nc" id="L177">  		}catch (SQLException e) {</span>
<span class="nc" id="L178">  			e.printStackTrace();</span>
<span class="nc" id="L179">  			return false;</span>
  		} finally{
<span class="nc" id="L181">  			try{</span>
<span class="nc" id="L182">  				rs.close();</span>
<span class="nc" id="L183">  				st.close();</span>
  				}
<span class="nc" id="L185">  			catch(Exception e){</span>
<span class="nc" id="L186">  				System.out.println(&quot;Error closing the database&quot;);</span>
<span class="nc" id="L187">  			}</span>
  		}	 		
  	}
  	
  	//sets a new email for an existing customer
  	public boolean changeCustomerEmail(int customerId, String newEmail){
  		Connection con;
<span class="nc" id="L194">  		Statement st = null;</span>
<span class="nc" id="L195">  		ResultSet rs = null;</span>
  		
  		try {
<span class="nc" id="L198">  			Class.forName(&quot;org.sqlite.JDBC&quot;);</span>
<span class="nc" id="L199">  			con = DriverManager.getConnection(&quot;jdbc:sqlite:warehouse.db&quot;);</span>
<span class="nc" id="L200">  			st = con.createStatement();</span>
<span class="nc" id="L201">  		}catch(Exception e){</span>
  			
<span class="nc" id="L203">  			System.err.println( e.getClass().getName() + &quot;: &quot; + e.getMessage() );</span>
<span class="nc" id="L204">  			System.exit(0);</span>
<span class="nc" id="L205">  			}</span>
  		
  		try {
<span class="nc" id="L208">  			st.executeUpdate(&quot;UPDATE customer SET email = '&quot;+ newEmail +</span>
  					&quot;' WHERE id = &quot;+ customerId +&quot;;&quot;);			
<span class="nc" id="L210">  			return true;</span>
<span class="nc" id="L211">  		}catch (SQLException e) {</span>
<span class="nc" id="L212">  			e.printStackTrace();</span>
<span class="nc" id="L213">  			return false;</span>
  		}finally{
<span class="nc" id="L215">  			try{</span>
<span class="nc" id="L216">  				rs.close();</span>
<span class="nc" id="L217">  				st.close();</span>
  				}
<span class="nc" id="L219">  			catch(Exception e){</span>
<span class="nc" id="L220">  				System.out.println(&quot;Error closing the database&quot;);</span>
<span class="nc" id="L221">  			}</span>
  		}	
  	}
  	
  	//gets the customer id with the email
  	public String[] getDataByEmail(String email){
<span class="nc" id="L227">  		String dataByEmail[] = new String[]{&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;};</span>
  		try {
<span class="nc" id="L229">  			rs = st.executeQuery(&quot;SELECT * FROM customer WHERE email = '&quot; + email + &quot;';&quot;);</span>
<span class="nc" id="L230">  			System.out.println();</span>
<span class="nc" id="L231">  			dataByEmail[0] = rs.getString(&quot;id&quot;);</span>
<span class="nc" id="L232">  			dataByEmail[1] = rs.getString(&quot;firstName&quot;);</span>
<span class="nc" id="L233">  			dataByEmail[2] = rs.getString(&quot;lastName&quot;);</span>
<span class="nc" id="L234">  			dataByEmail[3] = rs.getString(&quot;email&quot;);</span>
  			//int id =rs.getInt(&quot;id&quot;);
  			//System.out.printf(&quot;id: &quot;+ id);
  			
<span class="nc" id="L238">  			return dataByEmail;</span>
  		
<span class="nc" id="L240">  		} catch (SQLException e) {</span>
<span class="nc" id="L241">  			e.printStackTrace();</span>
  		}finally{
<span class="nc" id="L243">  			try{</span>
<span class="nc" id="L244">  				rs.close();</span>
<span class="nc" id="L245">  				st.close();</span>
  				}
<span class="nc" id="L247">  			catch(Exception e){</span>
<span class="nc" id="L248">  				System.out.println(&quot;Error closing the database&quot;);</span>
<span class="nc" id="L249">  			}</span>
<span class="nc" id="L250">  		}</span>
<span class="nc" id="L251">  		return dataByEmail;</span>
  	}
  	
  //gets the customer id with the email
  	public int getIdByEmail(String email){
<span class="nc" id="L256">  		int userId= 0;</span>
  		try {
<span class="nc" id="L258">  			rs = st.executeQuery(&quot;SELECT * FROM customer WHERE email = '&quot; + email + &quot;';&quot;);</span>
<span class="nc" id="L259">  			System.out.println();</span>
<span class="nc" id="L260">  			userId = rs.getInt(&quot;id&quot;);</span>
<span class="nc" id="L261">  			return userId;</span>
  		
<span class="nc" id="L263">  		} catch (SQLException e) {</span>
<span class="nc" id="L264">  			e.printStackTrace();</span>
<span class="nc" id="L265">  			return userId;</span>
  		}finally{
<span class="nc" id="L267">  			try{</span>
<span class="nc" id="L268">  				rs.close();</span>
<span class="nc" id="L269">  				st.close();</span>
  				}
<span class="nc" id="L271">  			catch(Exception e){</span>
<span class="nc" id="L272">  				System.out.println(&quot;Error closing the database&quot;);</span>
<span class="nc" id="L273">  			}</span>
  		}  		
  	}
  	
  	//retrieves all customer data with an id
  	public String[] getCustomerData(int customerId){
<span class="nc" id="L279">  		String[] customerDataString = {&quot;&quot;,&quot;&quot;,&quot;&quot;};</span>
  		try {
  			
<span class="nc" id="L282">  			rs = st.executeQuery(&quot;SELECT * FROM customer WHERE id = &quot; + customerId + &quot;;&quot;);</span>
  			
<span class="nc" id="L284">  			customerDataString[0] =  rs.getString(&quot;firstName&quot;);</span>
<span class="nc" id="L285">  			customerDataString[1] = rs.getString(&quot;lastName&quot;);</span>
<span class="nc" id="L286">  			customerDataString[2] = rs.getString(&quot;email&quot;);</span>
  						
<span class="nc" id="L288">  			return customerDataString;</span>
<span class="nc" id="L289">  		} catch (SQLException e) {</span>
<span class="nc" id="L290">  			e.printStackTrace();</span>
  		}finally{
<span class="nc" id="L292">  			try{</span>
<span class="nc" id="L293">  				rs.close();</span>
<span class="nc" id="L294">  				st.close();</span>
  				}
<span class="nc" id="L296">  			catch(Exception e){</span>
<span class="nc" id="L297">  				System.out.println(&quot;Error closing the database&quot;);</span>
<span class="nc" id="L298">  			}</span>
<span class="nc" id="L299">  		}</span>
  		
<span class="nc" id="L301">  		return customerDataString;</span>
  	}    
    
	// retrieving a unit by customer ID
	public int[] largeUnitsByCustomer(int customerId){
<span class="nc" id="L306">		int[] largeWare = new int[5];</span>
<span class="nc" id="L307">		int[] empty = new int[]{0};</span>
<span class="nc" id="L308">		int i=0;</span>
		try {
<span class="nc" id="L310">			rs = st.executeQuery(&quot;SELECT * FROM units WHERE customerId = &quot; + customerId  +&quot; AND warehouseId = 1;&quot;);</span>
<span class="nc bnc" id="L311" title="All 2 branches missed.">			while(rs.next()){</span>
<span class="nc" id="L312">				largeWare[i] = rs.getInt(&quot;warehouseId&quot;);</span>
<span class="nc" id="L313">				i++;</span>
			}
<span class="nc" id="L315">			return largeWare;</span>
<span class="nc" id="L316">		}catch (SQLException e) {</span>
			
<span class="nc" id="L318">			e.printStackTrace();</span>
<span class="nc" id="L319">			return empty;</span>
		}finally{
<span class="nc" id="L321">  			try{</span>
<span class="nc" id="L322">  				rs.close();</span>
<span class="nc" id="L323">  				st.close();</span>
  				}
<span class="nc" id="L325">  			catch(Exception e){</span>
<span class="nc" id="L326">  				System.out.println(&quot;Error closing the database&quot;);</span>
<span class="nc" id="L327">  			}</span>
  		}
	
	}
  	
	// retrieving a unit by customer ID
	public int[] smallUnitsByCustomer(int customerId){
<span class="nc" id="L334">		int[] smallWare = new int[10];</span>
<span class="nc" id="L335">		int[] empty = new int[]{0};</span>
<span class="nc" id="L336">		int i=0;</span>
		try {
<span class="nc" id="L338">			rs = st.executeQuery(&quot;SELECT * FROM units WHERE customerId = &quot; + customerId  +&quot; AND warehouseId = 2;&quot;);</span>
<span class="nc bnc" id="L339" title="All 2 branches missed.">			while(rs.next()){</span>
<span class="nc" id="L340">				smallWare[i] = rs.getInt(&quot;warehouseId&quot;);</span>
<span class="nc" id="L341">				i++;</span>
<span class="nc" id="L342">				System.out.println(i);</span>
			}
<span class="nc" id="L344">			return smallWare;</span>
<span class="nc" id="L345">		}catch (SQLException e) {</span>
<span class="nc" id="L346">			e.printStackTrace();</span>
<span class="nc" id="L347">			return empty;</span>
		}finally{
<span class="nc" id="L349">  			try{</span>
<span class="nc" id="L350">  				rs.close();</span>
<span class="nc" id="L351">  				st.close();</span>
  				}
<span class="nc" id="L353">  			catch(Exception e){</span>
<span class="nc" id="L354">  				System.out.println(&quot;Error closing the database&quot;);</span>
<span class="nc" id="L355">  			}</span>
  		}
	
	}  

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.4.201502262128</span></div></body></html>